<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Macrodata Refinement Simulator</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background-color: #111;
      overflow: hidden;
    }
    canvas {
      display: block;
      background: #222;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
<canvas id="refinementCanvas"></canvas>
<script>
  // Base styling params
  const digitSize = 14;      // base font size for digits (px)
  const rowSpacing = 26;     // vertical spacing (px)
  const colSpacing = 20;     // horizontal spacing (px)
  const radius = 100;        // distance around cursor for scaling
  const maxScale = 2.5;      // maximum scale factor at cursor center

  const canvas = document.getElementById("refinementCanvas");
  const ctx = canvas.getContext("2d");

  // Make canvas fill the entire window
  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }

  resizeCanvas();

  // Determine how many rows/cols fit on the screen
  let rows = Math.floor(canvas.height / rowSpacing);
  let cols = Math.floor(canvas.width / colSpacing);

  // Create a 2D array of random digits
  let randomDigits = [];
  function createDigits() {
    randomDigits = [];
    for (let r = 0; r < rows; r++) {
      randomDigits[r] = [];
      for (let c = 0; c < cols; c++) {
        randomDigits[r][c] = Math.floor(Math.random() * 10);
      }
    }
  }

  createDigits();

  // Track mouse position
  let mouseX = -9999, mouseY = -9999;

  canvas.addEventListener("mousemove", (e) => {
    const rect = canvas.getBoundingClientRect();
    mouseX = e.clientX - rect.left;
    mouseY = e.clientY - rect.top;
  });

  // If user resizes the window, re-fit the canvas and re-generate digits
  window.addEventListener("resize", () => {
    resizeCanvas();
    rows = Math.floor(canvas.height / rowSpacing);
    cols = Math.floor(canvas.width / colSpacing);
    createDigits();
  });

  // Main loop
  function draw() {
    // clear background
    ctx.fillStyle = "#222";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "#0ff";
    ctx.textBaseline = "middle";
    ctx.textAlign = "center";

    for (let r = 0; r < rows; r++) {
      for (let c = 0; c < cols; c++) {
        const digit = randomDigits[r][c];

        // cell center
        const x = c * colSpacing + colSpacing / 2;
        const y = r * rowSpacing + rowSpacing / 2;

        // distance to mouse
        const dx = x - mouseX;
        const dy = y - mouseY;
        const dist = Math.sqrt(dx*dx + dy*dy);

        // scale if within radius
        let scale = 1;
        if (dist < radius) {
          scale = 1 + (maxScale - 1) * (1 - dist / radius);
        }

        ctx.font = `${digitSize * scale}px monospace`;
        ctx.fillText(digit, x, y);
      }
    }

    requestAnimationFrame(draw);
  }

  draw();
</script>
</body>
</html>